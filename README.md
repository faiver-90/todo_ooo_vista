# ToDo OOO Vista

Небольшой сервис управления задачами: создание, изменение, отметка о выполнении и удаление. Бэкенд на FastAPI, асинхронный SQLAlchemy и PostgreSQL. Ниже — простая инструкция запуска через Docker Compose.

## Стек
- FastAPI
- SQLAlchemy (async)
- PostgreSQL 14+
- Nginx (reverse proxy)
- PgBouncer (pooling)

## Требования
- Установленные Docker и Docker Compose
- Порт `8000` свободен для Nginx (веб)
- Порт `8001` свободен для приложения (FastAPI)
- Порт `5432` свободен для PostgreSQL
- Порт `6432` свободен для PgBouncer

## Быстрый старт (Docker Compose)
1) Склонируйте репозиторий и перейдите в папку проекта.

2) Проверьте/создайте файл `.env` в корне проекта. Пример значений в файле `.env_sample`
Примечание: внутри контейнера бэкенд подключается к PgBouncer по имени сервиса, это уже задано в `docker-compose.yml`. Менять `DATABASE_URL` в `.env` не требуется.

3) Поднимите контейнеры:
- Активировать Docker Swarm `docker swarm init`
- С пересборкой образов: `docker compose up -d --build`
- Или по шагам: `docker compose build` затем `docker compose up -d`

4) Дождитесь старта. При запуске автоматически применяются миграции Alembic.

5) Откройте в браузере:
- `http://localhost:8000/swagger`

## Структура сервисов и порты
- `nginx` — проксирует запросы на приложение; внешний порт `8000`
- `app` (FastAPI) — приложение на `uvicorn`; внешний порт `8001`
- `pgbouncer` — пулер соединений к БД; внешний порт `6432`
- `db` (PostgreSQL) — база данных; внешний порт `5432`

Дефолтные доступы к БД: пользователь `pgres`, пароль `pgres`, база `pgres`.

## Миграции
Миграции применяются автоматически на старте контейнера приложения (`alembic upgrade head`).


